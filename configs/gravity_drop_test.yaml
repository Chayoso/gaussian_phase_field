# Gravity Drop Showcase
# Stanford bunny free-falls onto a rigid floor and shatters.
# 100 frames @ 30 FPS = 3.3s video

simulation:
  name: "gravity_drop_showcase"
  description: "Bunny drops onto ground plane â€” brittle fracture on impact"
  mode: "deformation"
  output_dir: "output"
  save_frames: true
  save_checkpoint: false

mesh:
  path: "assets/meshes/bunny.obj"
  auto_generate_if_missing: true
  test_mesh_type: "sphere"
  test_mesh_radius: 0.4

particles:
  target_count: 300000
  surface_ratio: 0.5
  use_poisson_sampling: false
  poisson_depth: 8
  normalize_to_unit_cube: true

mpm:
  num_grids: 128
  dt: 1.0e-4
  gravity: [0.0, 0.0, -300.0]
  clip_bound: 0.05
  damping: 0.9995
  particle_chunk: 8192

material:
  preset: null
  constitutive_model: "corotated_phase_field"
  center: [0.5, 0.5, 0.5]
  size: [0.8, 0.8, 0.8]
  density: 1200.0
  youngs_modulus: 5.0e6
  poissons_ratio: 0.25
  Gc: 120000.0
  l0: 0.025
  degradation_exponent: 3.0

phase_field:
  warmup_frames: 1
  dC_max: 0.25
  crack_tip_speed: 8.0
  crack_width: 0.004
  max_total_cracks: 48
  crack_aniso_ratio: 200.0
  branch_angle: 25.0
  branch_min_length: 4
  branch_probability: 0.50
  max_branches_per_path: 3
  nucleation_fraction: 0.35
  max_nucleation_per_frame: 1
  nucleation_min_spacing: 10
  fragmentation_enabled: true
  fragment_damage_threshold: 0.5
  min_fragment_particles: 50

seismic:
  enabled: true                   # Overridden to false by gravity_drop
  amplitude: 1500.0
  frequency: 80.0
  direction: [1.0, 0.3, 0.0]
  ramp_time: 0.005

pre_notch:
  enabled: false

external_force:
  enabled: false

ground_plane:
  enabled: true
  point: [0.5, 0.5, 0.05]
  normal: [0.0, 0.0, 1.0]
  surface_type: "slip"
  friction: 0.5

loading:
  type: "gravity_drop"
  drop_scale: 0.33
  drop_center_z: 0.7

coordinate_mapping:
  world_center: [0.5, 0.5, 0.5]
  world_scale: 1.0

damage_projection:
  method: "knn_weighted"
  k_neighbors: 8
  influence_radius: 0.05
  damage_threshold: 0.01
  use_faiss: true

gaussian_splatting:
  sh_degree: 3
  crack_color: [0.6, 0.08, 0.08]
  opacity_mode: "smooth"
  color_mode: "overlay"
  scale_mode: null
  damage_threshold: 0.45
  sharp_k: 50.0
  edge_width: 0.02
  crack_opacity_reduction: 0.70
  crack_max_opening: 0.010
  crack_gap_fraction: 0.35
  crack_edge_darken: 0.75
  crack_red_accent: 0.10

rendering:
  image_width: 1920
  image_height: 1920
  background_color: [1.0, 1.0, 1.0]
  camera:
    distance: 0.85
    elevation: 25.0
    azimuth: 30.0
    fov: 50.0
    target: [0.5, 0.5, 0.30]
  total_frames: 100
  fps: 30
  physics_substeps: 15

output:
  video_path: "output/gravity_drop_showcase.mp4"
  frame_dir: "output/frames"
  statistics_log: "output/statistics.csv"
  checkpoint_dir: "output/checkpoints"
  log_interval: 50
  verbose: true

device:
  type: "cuda"
  gpu_id: 0
